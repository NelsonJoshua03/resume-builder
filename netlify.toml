[build]
  command = "npm run build"
  publish = "dist"
  functions = "netlify/functions"

[dev]
  targetPort = 3001
  framework = "vite"

# Environment variables
[build.environment]
  NODE_VERSION = "20"
  NPM_FLAGS = "--legacy-peer-deps"

[context.production.environment]
  NODE_VERSION = "20"
  NPM_FLAGS = "--legacy-peer-deps"

[context.deploy-preview.environment]
  NODE_VERSION = "20"
  NPM_FLAGS = "--legacy-peer-deps"

[context.branch-deploy.environment]
  NODE_VERSION = "20"
  NPM_FLAGS = "--legacy-peer-deps"

# Plugin for better Node.js support
[[plugins]]
  package = "@netlify/plugin-lighthouse"

# Edge Functions (if needed)
[[edge_functions]]
  path = "/api/*"
  function = "api"

# Redirects for SEO - UPDATED FOR CAREERCRAFT.IN
[[redirects]]
  from = "https://resumecvforge.netlify.app/*"
  to = "https://careercraft.in/:splat"
  status = 301

[[redirects]]
  from = "http://careercraft.in/*"
  to = "https://careercraft.in/:splat"
  status = 301

# Priority redirects for SEO files
[[redirects]]
  from = "/sitemap.xml"
  to = "/sitemap.xml"
  status = 200
  force = true

[[redirects]]
  from = "/robots.txt"
  to = "/robots.txt"
  status = 200
  force = true

# Redirect for Google verification file
[[redirects]]
  from = "/google213349ae4cc6099f.html"
  to = "/google213349ae4cc6099f.html"
  status = 200
  force = true

# Blog redirects for better SEO
[[redirects]]
  from = "/blog/*"
  to = "/blog/:splat"
  status = 200

# SPA fallback for all other routes (must come last)
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200